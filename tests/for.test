/*
  Tests for the 'for' meta control structure. Test source is formatted
  oddly to make the expected output easier to manage (e.g., newlines in
  expected output are avoided)
*/

test {
  
  context = {
    a = [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]
  }
  
  source = <<SOURCE
    @for _, e := range a { A }
SOURCE
  
  expect = <<RESULT
     This is displayed if 'a' is true, which it is. 
RESULT
  
}

test {
  
  context = {
    a = [ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]
  }
  
  source = <<SOURCE
    @for i, e := range a { @(i) = @(e + 10) }
SOURCE
  
  expect = <<RESULT
     0 = 10  1 = 11  2 = 12  3 = 13  4 = 14  5 = 15  6 = 16  7 = 17  8 = 18  9 = 19 
RESULT
  
}

test {
  
  context = {
    a = {
      a = { v = 0 }
      b = { v = 1 }
      c = { v = 2 }
      d = { v = 3 }
    }
  }
  
  source = <<SOURCE
    @for k, e := range a { @(k) = @(e) }
SOURCE
  
  expect = <<RESULT
     0  1  2  3 
RESULT
  
}
